<!DOCTYPE html>
<html>
<head>
<title>Receipt Verification</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">
<div class="card shadow mx-auto" style="max-width:500px;">
<div class="card-header bg-dark text-white">
<h5>Verify Donation Receipt</h5>
</div>

<div class="card-body">

<div id="errorMsg" class="alert alert-danger d-none"></div>

<div class="mb-3">
<label>Receipt Number</label>
<input type="text" id="receipt_no" class="form-control">
</div>

<div class="mb-3">
<label>Mobile Number</label>
<input type="text" id="mobile" class="form-control">
</div>

<button class="btn btn-primary w-100" onclick="verifyReceipt()">
Verify
</button>

<div id="generateSection" class="text-center mt-3 d-none">
<a id="downloadBtn" class="btn btn-success" target="_blank">
Download PDF Receipt
</a>
</div>

</div>
</div>
</div>

<script>
function verifyReceipt(){

  const receipt = document.getElementById("receipt_no").value;
  const mobile = document.getElementById("mobile").value;

  fetch(`/receipt-validate?receipt=${receipt}&mobile=${mobile}`)
  .then(res=>res.json())
  .then(data=>{

    if(data.valid){
      document.getElementById("generateSection").classList.remove("d-none");
      document.getElementById("downloadBtn").href =
        `/receipt-pdf/${receipt}/${mobile}`;
      document.getElementById("errorMsg").classList.add("d-none");
    } else {
      document.getElementById("errorMsg").innerText =
        "Invalid Receipt or Mobile Number";
      document.getElementById("errorMsg").classList.remove("d-none");
      document.getElementById("generateSection").classList.add("d-none");
    }

  });
}
</script>

</body>
</html>
